{
    "collab_server" : "",
    "contents" : "employee92_95.melt <- melt(employee92_95, id = \"目錄\")\nWarning message:\n  attributes are not identical across measure variables; they will be dropped \n> View(employee92_95.melt)\n> View(employee92_95)\n> year <- c(rep(92:95,each = 64))\n> employee92_95.melt <- cbind(employee92_95.melt, year)\n> View(employee92_95.melt)\n\n\n> data_summar <- employee92_95.melt[seq(1, 256, by = 8),]\n> View(data_summar)\n> data_summary <- data_summar\n> View(data_summary)\n> data_tmp <- data_summary\n> people92_95 <- data_tmp[seq(1, 32, by = 2),]\n> View(people92_95)\n> people92_95[,1] <- c(rep(\"受僱人數\",16))\n\n\nt_employee92_95 <- t(employee92_95)\ntmp_data <- t_employee92_95[,c(1,9)] \ntype <- c(rep(\"住宿及餐飲業\",4), rep(\"金融及保險業\",4), rep(\"醫療保健服務業\",4), rep(\"藝術、娛樂及休閒服務業\",4))\ntmp_data <- tmp_data[-1,]\ntmp_data <- cbind(tmp_data, type)\nrowname <- rownames(tmp_data)\nrownames(tmp_data) <- NULL\ntmp_data <- as.data.frame(tmp_data)\ncolnames(tmp_data) <- c(\"受僱人數\", \"薪資\", \"行業別\")\nyear <- c(rep(92:95,4))\ntmp_data <- cbind(tmp_data, year)\nstr(tmp_data)\ntmp_data$行業別 <- as.character(tmp_data$行業別)\n\n### 處理有逗點的數值\nlibrary(dplyr)\ncount <- function(x, y) {\n  x %>%  \n    as.character() %>% \n    strsplit(\",\") -> x\n  for(i in 1:y){\n    x[[i]] <- paste0(x[[i]][1], x[[i]][2])\n  }\n  as.numeric(unlist(x))\n}\n\ntmp_data$受僱人數 <- count(tmp_data$受僱人數, 16)\ntmp_data$薪資 <- count(tmp_data$薪資, 16)\n\ntmp_data <- bind_cols(tmp_data[,3:4], tmp_data[,1:2])\n\n\n\n#刪除行資料並給col名字  \ndel <- function(x, nam, n) {\n  x <- x[-c(1:2,11:14),]\n  colnames(x) <- c(nam, rep(\"住宿及餐飲業\",n), rep(\"金融及保險業\",n), rep(\"醫療保健服務業\",n), rep(\"藝術、娛樂及休閒服務業\",n))\n  x\n}\n\n\n#刪除行資料並給col名字  \ndel2 <- function(x, nam, n, f, t) {\n  x <- x[-c(1:2,f:t),]\n  colnames(x) <- c(nam, rep(\"住宿及餐飲業\",n), rep(\"金融及保險業\",n), rep(\"醫療保健服務業\",n), rep(\"藝術、娛樂及休閒服務業\",n))\n  x\n}\n\n#轉置\nexchange <- function(x, y = type_n, z=rept_year) {\n  x <- t(x)\n  x <- x[,c(1,9)]\n  f_type <- c(rep(\"住宿及餐飲業\",y), rep(\"金融及保險業\",y), rep(\"醫療保健服務業\",y), rep(\"藝術、娛樂及休閒服務業\",y))\n  x <- x[-1,]\n  x <- cbind(x, f_type)\n  rowname <- rownames(x)\n  rownames(x) <- NULL\n  x <- as.data.frame(x)\n  colnames(x) <- c(\"受僱人數\", \"薪資\", \"行業別\")\n  year <- c(rep(z,4))\n  x <- cbind(x, year)\n  x$行業別 <- as.character(x$行業別)\n  x\n}\n\n#employee_97_99\nw <- del(employee97_99, \"種類\", 3)\nw <- exchange(w, 3, 97:99)\nw$受僱人數 <- count(w$受僱人數, 12)\nw$薪資 <- count(w$薪資,12)\nw <- bind_cols(w[,3:4], w[,1:2])\n\n#employee100_101\nv <- del(employee100_101, \"種類\", 2)\nv <- exchange(v, 2, 100:101)\nv$受僱人數 <- count(v$受僱人數, 8)\nv$薪資 <- count(v$薪資,8)\nv <- bind_cols(v[,3:4], v[,1:2])\ntmp_data <- bind_rows(tmp_data,v)\n\n#employee102-104\nm <- del(employee102_104, \"種類\", 3)\nm <- exchange(m, 3, 102:104)\nm$受僱人數 <- count(m$受僱人數, 12)\nm$薪資 <- count(m$薪資,12)\nm <- bind_cols(m[,3:4], m[,1:2])\ntmp_data <- bind_rows(tmp_data,m)\n\n#first92_95\nlibrary(reshape2)\na <- del2(first92_95, \"種類\", 4, 31, 34)\nt <- t(a)\nt <- t[,seq(1, 22, by = 7)]\nt [-1,]\nrowname92_95 <- c(rep(92:95, 4))\ntype1 <- c(\"住宿及餐飲業\", \"金融及保險業\", \"醫療保健服務業\", \"藝術、娛樂及休閒服務業\")\nt <- as.data.frame(t)\ncolnames(t) <- type1\nt$住宿及餐飲業 <- count(t$住宿及餐飲業, 16)\nt$金融及保險業 <- count(t$金融及保險業, 16)\nt$醫療保健服務業 <- count(t$醫療保健服務業, 16)\nt$`藝術、娛樂及休閒服務業` <- count(t$`藝術、娛樂及休閒服務業`, 16)\nt$year <- rownames(t)\nt.melt <- melt(t, id.var = 'year', variable.name = \"行業別\", value.name = \"初任人員薪資\")\n\n#整理first_data\nsor <- function(x, a, b, c, d) {\n    rowname <- c(a:b)  \n    z <- x[,1:(d+1)]\n    z <- z[-c(1:2),]\n    z <- z[seq(1,22, by = 7),]\n    z <- t(z) \n    z <- as.data.frame(z)\n    z <- z[-1,]\n    colnames(z) <- type1 \n    rownames(z) <- rowname\n    z$year <- rownames(z)\n    z <- melt(z, id.var = 'year', variable.name = \"行業別\", value.name = \"初任人員薪資\")\n    z$初任人員薪資 <- count(z$初任人員薪資, c)\n    z\n}\n    \n    \n    z <- z[-c(1:2,31:34),]\n    z <- z[,seq(1, ncol(z), by = 7)]  \n    z <- z[-1,]  \n    z <- as.data.frame(z) \n    z$住宿及餐飲業 <- count(z$住宿及餐飲業, c) \n    z$金融及保險業 <- count(z$金融及保險業, c) \n    z$醫療保健服務業 <- count(z$醫療保健服務業, c) \n    z$`藝術、娛樂及休閒服務業` <- count(z$`藝術、娛樂及休閒服務業`, c) \n    z$year <- rownames(z)  \n    z.melt <- melt(z, id.var = 'year', variable.name = \"行業別\", value.name = \"初任人員薪資\")\n\n    \n#檔案結合做key值\n    tmp_data$key <- paste0(tmp_data$行業別, tmp_data$year)\n    t.melt$key <- paste0(t.melt$行業別, t.melt$year)\n    tmp_data <- left_join(tmp_data, t.melt[,3:4], by = \"key\")\n    \n    \n# worktime\n    h <- worktime92_95[-c(1,2),-1]\n    h <- as.data.frame(t(h))\n    colnames(h) <- type1\n    rownames(h) <- c(92:95)\n    \n#worktime function\n    work <- function(x, a, b) {\n      x <- x[-c(1,2), -1]\n      x <- as.data.frame(t(x))\n      colnames(x) <- type1\n      rownames(x) <- c(a:b)\n      x$year <- rownames(x)\n      x <- melt(x, id.var = 'year', variable.name = \"行業別\", value.name = \"工作時數\")\n    }\n    \n    worktime <- bind_rows(work(worktime92_95, 92, 95), work(worktime97_99, 97, 99), work(worktime100_101,100, 101), work(worktime102_104, 102, 104))\n    tmp_data <- left_join(tmp_data, worktime[,3:4], by = \"key\")\na <- exchange(a, 4, 92:95)\nw$受僱人數 <- count(w$受僱人數, 12)\nw$薪資 <- count(w$薪資,12)\nw <- bind_cols(w[,3:4], w[,1:2])",
    "created" : 1467338716741.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4236051032",
    "id" : "F3A62FF3",
    "lastKnownWriteTime" : 1467564504,
    "last_content_update" : 1467564504189,
    "path" : "~/R_DSP/DSP_camp/tmp.R",
    "project_path" : "tmp.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}